#define _CRT_SECURE_NO_WARNINGS 1
#include<stdio.h>
#include<string.h>
#include<errno.h>
//int main()
//{
//	FILE* pf=fopen("text.txt","w");
//	//
//	if (pf == NULL)
//	{
//		printf("%s ",strerror(errno));
//	}
//	//写文件
//	fputc("b",pf);
//	fputc("i",pf);
//	fputc("t",pf);
//	//关闭文件
//	fclose(pf);
//	pf = NULL;
//	return 0;
//}
//int main()
//{
//	FILE* pf = fopen("text.txt", "r");
//	//
//	if (pf == NULL)
//	{
//		printf("%s ", strerror(errno));
//	}
//	//读文件
//	int ch = fgetc(pf);
//	printf("%c ",ch);
//	ch=fgetc(pf);
//	printf("%c ", ch);
//	ch = fgetc(pf);
//	printf("%c ", ch);
//	//关闭文件
//	fclose(pf);
//	pf = NULL;
//	return 0;
//}
/*
   文本行输入函数:fgetc()
    char * fgets(char * string,int n,FILE * stream);
   文本行输出函数:fputc()
    char * fputs(const char * string,FILE * stream);
   int puts(const char* strmg);
*/
//int main()
//{
//	char buf[1024] = {0};
//	FILE* pf = fopen("text.txt","r");
//	if (pf==NULL)
//	{
//		return 0;
//	}
//	//读文件
//	fgets(buf,1024,pf);
//	//printf("%s",buf);
//	puts(buf);
//	fgets(buf,1024,pf);
//	//printf("%s",buf);
//	puts(buf);
//
//	//关闭文件
//	fclose(pf);
//	pf = NULL;
//	return 0;
//}
//int main()
//{
//	char buf[1024] = { 0 };
//	FILE* pf = fopen("text.txt", "w");
//	if (pf == NULL)
//	{
//		return 0;
//	}
//	//读文件
//	fputs("hello",pf);
//	fputs("world",pf);
//
//	//关闭文件
//	fclose(pf);
//	pf = NULL;
//	return 0;
//}

//int main()
//{
//    //从键盘读取一行文本信息
//    char buf[1024] = { 0 };
//    //fgets(buf,1024,stdin);//从标准输入流读取
//    //fputs(buf,stdout);//输出到标准输出流
//
//    gets(buf);
//    puts(buf);
//    return 0;
//}

/*
   格式化输入函数:fscanf()
   格式化输出函数:fprintf()
   int printf(const char* format[,argument]..);
   int fprintf(FILE * stream,const char* format[,argument]..);
   int scanf(const char* format[,argument]..);
   int fscanf(FILE * stream,const char* format[,argument]..);
*/
//struct S {
//    int n;
//    float f;
//    char arr[10];
//};
//int main()
//{
//    struct S s = { 100,3.14f,"bit" };
//    FILE* pf = fopen("text.txt","w");
//    if (pf == NULL)
//    {
//        return 0;
//    }
//    //格式化的形式写文件
//    fprintf(pf,"%d %f %s",s.n,s.f,s.arr);
//    return 0;
//}
//struct S {
//    int n;
//    float f;
//    char arr[10];
//};
//int main()
//{
//    struct S s = { 0 };
//    FILE* pf = fopen("text.txt", "r");
//    if (pf == NULL)
//    {
//        return 0;
//    }
//    //格式化的输入数据
//    fscanf(pf, "%d %f %s", &(s.n), &(s.f), s.arr);
//    printf("%d %f %s",s.n,s.f,s.arr);
//    return 0;
//}
//struct S {
//    int n;
//    float score;
//    char arr[10];
//};
//int main()
//{
//    struct S s = {0};
//
//    fscanf(stdin,"%d %f %s",&(s.n),&(s.score),s.arr);
//    fprintf(stdout,"%d %f %s",s.n,s.score,s.arr);
//
//    return 0;
//}
/* 对比一组函数:
  scanf/fscanf/sscanf
  printf/fprintf/sprintf
  scanf/printf   是针对标准输入流/标准输出流的 格式化输入/输出语句。
  fscanf/fprintf 是针对所有输入流/所有输出流的 格式化输入/输出语句。
  sscanf()函数: - 从字符串中读取格式化的数据
   int sscanf(const char* buffer,const char * format[,argument]..);
  sprintf()函数: - 把格式化的数据存储到(输出成)字符串
   int sprintf(char * buffer,const char * format[,argument]..);
*/
//struct S {
//    int n;
//    float score;
//    char arr[10];
//};
//int main()
//{
//    struct S s = {100,3.14f,"abcdef"};
//    struct S tmp;
//    char buf[1024] = {0};
//    //把格式化的数据转换成字符串存储到buf
//    sprintf(buf,"%d %f %s",s.n,s.score,s.arr);
//    //printf("%s\n",buf);
//    //从buf中读取格式化的数据到tmp中
//    sscanf(buf,"%d %f %s",&(tmp.n),&(tmp.score),tmp.arr);
//    printf("%d %f %s",tmp.n,tmp.score,tmp.arr);
//
//    return 0;
//}
/*
   fread()函数: 二进制输入函数
   size_t fread(void * buffer,size_t size,size_t count,FILE* stream);
   fwrite()函数: 二进制输出函数
   size_t fwrite(const void* buffer,size_t size,size_t count,FILE* stream);
*/
//struct S {
//    char name[20];
//    int age;
//    double score;
//};
//int main()
//{
//    struct S s = { "张三",20,89 };
//    FILE* pf = fopen("text.txt","wb");
//    if (pf == NULL)
//    {
//        return 0;
//    }
//    //二进制的形式写文件
//    fwrite(&s,sizeof(struct S),1,pf);
//    //关闭文件
//    fclose(pf);
//    pf = NULL;
//    return 0;
//}
struct S {
    char name[20];
    int age;
    double score;
};
int main()
{
    //struct S s = { "张三",20,89 };
    struct S tmp = {0};
    FILE* pf = fopen("text.txt", "rb");
    if (pf == NULL)
    {
        return 0;
    }
    //二进制的形式读文件
    fread(&tmp, sizeof(struct S), 1, pf);
    printf("%s %d %lf\n",tmp.name,tmp.age,tmp.score);
    //关闭文件
    fclose(pf);
    pf = NULL;
    return 0;
}
/*
   fseek()函数: 根据文件指针的位置和偏移量定位指针。
   int fseek(FILE* stream,long int offset,int origin);
   offset - 偏移量 - 单位是字节
   origin - 文件指针起始位置 - SEEK_CUR - 文件指针当前位置
                             - SEEK_END - 文件的末尾位置
                             - SEEK_SET - 文件的起始位置
*/
//int main()
//{
//    FILE* pf = fopen("test.txt","r");
//    if (pf == NULL)
//    {
//        return 0;
//    }
//    //1.定位文件指针
//    /*fseek(pf, 4, SEEK_CUR);*/
//    fseek(pf, -2, SEEK_END);
//    //2.读取文件
//    int ch = fgetc(pf);
//    printf("%c\n",ch);
//    //关闭文件
//    return 0;
//}

/*
   ftell()函数: 返回文件指针相对引用起始位置的偏移量.
   long int ftell(FILE * stream);
*/
//int main()
//{
//    FILE* pf = fopen("test.txt", "r");
//    if (pf == NULL)
//    {
//        return 0;
//    }
//    //1.定位文件指针
//    /*fseek(pf, 4, SEEK_CUR);*/
//    //fseek(pf, -2, SEEK_END);
//    fgetc(pf);
//    int pos = ftell(pf);
//    printf("%d ",pos);
//    //关闭文件
//    return 0;
//}

/*
   rewind()函数: 让文件指针的位置回到文件起始位置
   void rewind(FILE* stream);
*/
int main()
{
    FILE* pf = fopen("test.txt", "r");
    if (pf == NULL)
    {
        return 0;
    }
    //1.定位文件指针
    /*fseek(pf, 4, SEEK_CUR);*/
    //fseek(pf, -2, SEEK_END);
    int ch=fgetc(pf);
    printf("%c\n",ch);
    rewind(pf);//让文件指针的位置回到文件起始位置
    ch = fgetc(pf);
    printf("%c\n", ch);
    //关闭文件
    return 0;
}
/*文件结束判定
  被错误使用的feof:牢记:在读取文件过程中，不能直接用feof函数的返回值直接用来判断文件是否结束
                        而是应用于当文件读取结束的时候，判断是读取失败结束，还是遇到文件尾结束。
    1.文本文件读取是否结束,判断返回值是否为EOF(fgetc),或者NULL(fgetc)
              fgetc判断是否为EOF
              fgetc判断返回值是否为NULL
    2.二进制文件的读取结束判断，判断返回值是否小于实际要读的个数
              fread判断返回值是否小于实际要读的个数
*/
//int main()
//{
//    //EOF- (-1)
//    //feof();//EOF - end of file - 文件结束标志
//    FILE* pf = fopen("test.txt","r");
//    if (pf == NULL)
//    {
//        return 0;
//    }
//    int ch = fgetc(pf);
//    printf("%d ",ch);//-1
//    return 0;
//}
int main()
{
    FILE* pf = fopen("test.txt","r");
    if (pf == NULL)
    {
        perror("open file failed");
        return 0;
    }
    //读文件
    int ch;
    while ((ch = fgetc(pf))!=EOF)
    {
        putchar(ch);
    }
    if (ferror(pf))//ferror返回值为0，表示没错，非零表示出错
    {
        printf("error\n");
    }
    else if (feof(pf))
    {
        printf("end of file\n");
    }
    //关闭文件
    fclose(pf);
    pf = NULL;
    return 0;
}
